\section{Reachability/Controllability and Observability}

\subsection{Reachability/Controllability}

An LTI system is reachable if there exists a control signal that takes the system from an initial condition $x_0 = 0$ to any desired final state $x_f$, in finite time. This means that each state can be influenced by the input.

\begin{equation*}
    R:= \begin{bmatrix}
        B & AB & A^2B & A^3B & \cdots & A^{n-1}B
    \end{bmatrix}
\end{equation*}
Mathematically expressed, a system is reachable if and only if the reachability matrix $R$ has \textbf{full row rank} $n$.
\begin{align*}
    \text{rank}(R) & = n    \\
    \det(R)        & \neq 0
\end{align*}

\ptitle{SISO diagonal systems}

The $i$-th mode of a system in diagonal form is reachable only if $\tilde{b}_i \neq 0$ because
\begin{equation*}
    \tilde{x}_i^+ =\lambda_i\tilde{x}_i+\tilde{b}_i u
\end{equation*}
where $\tilde{x}_i^+$ includes $\dot{\tilde{x}}$ and $\tilde{x}[k+1]$. This is a necessary but not sufficient condition for reachability of the whole system.

\ptitle{DT Systems: Controllability}

\begin{itemize}
    \item A DT LTI system is controllable if, for any initial condition $x_0$, there exists a control input that brings the state $x$ to $0$ in finite time.
    \item Reachability always implies controllability
    \item Controllability only implies reachability if $A_d$ is invertible
    \item An unreachable DT system with non-invertible $A_d$ could be controllable (Eigenvalues at 0). E.g.:
          \begin{itemize}
              \item $x[k+1] = 0x[k] + 0u[k]$ is controllable (state goes to $0$) but unreachable as $\det(R)=0$.
          \end{itemize}
    \item For \textbf{continuous-time systems} controllability and reachability are the same.
\end{itemize}

% An LTI system is controllable if, for any initial condition $x_0$, there exists a control input that brings the state $x$ to $0$ in finite time.

% For continuous-time systems controllability and reachability are the same. However, for a discrete-time system with a non-invertible $A$ matrix there is a subtle difference. For example the DT system $x[k+1] = 0x[k] + 0u[k]$ is contr but unreachable.

\subsection{Observability}

An LTI system is observable if, for any initial condition $x_0$, this initial condition can be reconstructed uniquely based on the knowledge of the input and output signal over a finite time interval. This means that each state must influence the output.

\begin{equation*}
    O:= \begin{bmatrix}
        C      \\
        CA     \\
        CA^2   \\
        \vdots \\
        CA^{n-1}
    \end{bmatrix}
\end{equation*}
Mathematically expressed, a system is observable if and only if the observability matrix $O$ has \textbf{full column rank} $n$.
\begin{align*}
    \text{rank}(O) & = n    \\
    \det(O)        & \neq 0
\end{align*}

\ptitle{SISO diagonal systems}

The $i$-th mode of a system in diagonal form is observable only if $\tilde{c}_i \neq 0$ because
\begin{equation*}
    y=\tilde{c}_1\tilde{x}_1+\ldots+\tilde{c}_n\tilde{x}_n+Du
\end{equation*}
This is a necessary but not sufficient condition for observability of the whole system.

\subsection{Stabilizability and Detectability}
\begin{itemize}
    \item A system is stabilizable if all \textbf{unstable modes are reachable}.
    \item A system is detectable if all \textbf{unstable modes are observable}.
    \item In a system that is stabilizable and detectable all the modes that cannot be controlled and/or observed must behaving ``nicely'' on their own.
\end{itemize}

\subsection{Kalman Decomposition}

\ptitle{Diagonalizable system}
\begin{align*}
    \dot{x} & = \begin{bmatrix}
                    \Lambda_{r\bar{o}} & 0            & 0                        & 0                  \\
                    0                  & \Lambda_{ro} & 0                        & 0                  \\
                    0                  & 0            & \Lambda_{\bar{r}\bar{o}} & 0                  \\
                    0                  & 0            & 0                        & \Lambda_{\bar{r}o} \\
                \end{bmatrix}
    x + \begin{bmatrix}
            B_{r\bar{o}} \\
            B_{ro}       \\
            0            \\
            0            \\
        \end{bmatrix}
    u                                                                                                                           \\
    y       & = \begin{bmatrix}
                    0 & C_{ro} & 0 & C_{r\bar{o}}
                \end{bmatrix}
    + Du
\end{align*}

\ptitle{General case}
\begin{align*}
    \dot{x} & = \begin{bmatrix}
                    A_{r\bar{o}} & A_{12} & A_{13}             & A_{14}       \\
                    0            & A_{ro} & 0                  & A_{24}       \\
                    0            & 0      & A_{\bar{r}\bar{o}} & A_{34}       \\
                    0            & 0      & 0                  & A_{\bar{r}o} \\
                \end{bmatrix}
    x + \begin{bmatrix}
            B_{r\bar{o}} \\
            B_{ro}       \\
            0            \\
            0            \\
        \end{bmatrix}
    u                                                                                                   \\
    y       & = \begin{bmatrix}
                    0 & C_{ro} & 0 & C_{r\bar{o}}
                \end{bmatrix}
    + Du
\end{align*}

\newpar{}

\begin{tabularx}{\linewidth}{@{}ll@{}}
    $r$       & reachable      \\
    $\bar{r}$ & not reachable  \\
    $o$       & observable     \\
    $\bar{o}$ & not observable \\
\end{tabularx}

\ptitle{Remarks}
\begin{itemize}
    \item In the transfer function $u \rightarrow y$ only the modes corresponding to the reachable and observable modes will appear (others will be cancelled by a zero).
    \item A minimal realization of a transfer function is a state-space model that is both reachable and observable.
\end{itemize}